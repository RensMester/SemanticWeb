<!DOCTYPE html>
<html>
  <head>
	<link rel="stylesheet" type="text/css" href="style.css">
	<script src="http://code.jquery.com/jquery-latest.min.js"></script> 
	<script src="http://openlayers.org/en/v3.10.1/build/ol.js" type="text/javascript"></script>
	<link rel="stylesheet" href="http://openlayers.org/en/v3.10.1/css/ol.css" type="text/css"> 
</head>
  
  
  <body>
    <div id="map" style="width: 100%, height: 400px"></div>
	<script src="http://www.openlayers.org/api/OpenLayers.js"></script>
	  
	  <script>
		(function(){
    var vectorSource = new ol.source.Vector({
      //create empty vector
    });
    
    //create a bunch of icons and add to source vector
	$.getJSON('route.json', function(data) { 
            
		//MARKERS
		
		$.each( data.routes[0].legs[0].steps, function(i, value) {
			console.log(i,value);
			var iconFeature = new ol.Feature({
				geometry: new  
            ol.geom.Point(ol.proj.transform([value.start_location.lat, value.start_location.lng], 'EPSG:4326',   'EPSG:3857')),
			});
			vectorSource.addFeature(iconFeature);
		});
	});
    /*for (var i=0;i<50;i++){
 
        var iconFeature = new ol.Feature({
          geometry: new  
            ol.geom.Point(ol.proj.transform([Math.random()*360-180, Math.random()*180-90], 'EPSG:4326',   'EPSG:3857')),
        name: 'Null Island ' + i,
        population: 4000,
        rainfall: 500
        });
        vectorSource.addFeature(iconFeature);
    }*/

    //create the style
    var iconStyle = new ol.style.Style({
      image: new ol.style.Icon(/** @type {olx.style.IconOptions} */ ({
        anchor: [0.5, 46],
        anchorXUnits: 'fraction',
        anchorYUnits: 'pixels',
        opacity: 0.75,
        src:'https://cdn1.iconfinder.com/data/icons/Map-Markers-Icons-Demo-PNG/256/Map-Marker-Marker-Outside-Pink.png',
		scale: 0.15,		
      }))
    });



    //add the feature vector to the layer vector, and apply a style to whole layer
    var vectorLayer = new ol.layer.Vector({
      source: vectorSource,
      style: iconStyle
    });
	
    var map = new ol.Map({
      layers: [new ol.layer.Tile({ source: new ol.source.OSM() }), vectorLayer],
      target: document.getElementById('map'),
      view: new ol.View({
        center: [0, 0],
        zoom: 3
      })
    });
})();
	  </script>
  </body>
</html>


<!--
$.getJSON('route.json', function(data) { 
            
		//MARKERS
		
		$.each( data.routes[0].legs[0].steps, function(i, value) {
			console.log(i,value);
			var myLatlng = new OpenLayers.LatLng(value.start_location.lat, value.start_location.lng)
				.transform(
					new OpenLayers.Projection("EPSG:4326"),
					map.getProjectionObject());
			markers.addMarker( new OpenLayers.Marker(myLatlng));
		});
	});
-->